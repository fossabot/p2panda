{
    "openrpc": "1.0.0-rc1",
    "info": {
        "title": "p2panda RPC interface",
        "version": "0.0.1"
    },
    "components": {
        "contentDescriptors": {
            "EntryArgs": {
                "name": "entryArgs",
                "required": true,
                "description": "Arguments for next entry in log",
                "schema": {
                    "$ref": "#/components/schemas/EntryArgs"
                }
            },
            "Author": {
                "name": "author",
                "required": true,
                "description": "The public key of author",
                "schema": {
                    "$ref": "#/components/schemas/Author"
                }
            },
            "Schema": {
                "name": "schema",
                "required": true,
                "description": "The hash of schema describing format of message fields",
                "schema": {
                    "$ref": "#/components/schemas/Hash"
                }
            }
        },
        "schemas": {
            "Author": {
                "type": "string",
                "pattern": "[0-9a-fa-f]{64}",
                "minLength": 64,
                "maxLength": 64
            },
            "Hash": {
                "type": "string",
                "minLength": 132,
                "maxLength": 132,
                "pattern": "[0-9a-fa-f]{132}"
            },
            "EntryArgs": {
                "type": "object",
                "properties": {
                    "entryHashSkiplink": {
                        "$ref": "#/components/schemas/Hash"
                    },
                    "entryHashBacklink": {
                        "$ref": "#/components/schemas/Hash"
                    },
                    "seqNum": {
                        "type": "number"
                    },
                    "logId": {
                        "type": "number"
                    }
                }
            },
            "Entry": {
                "type": "object",
                "properties": {
                    "author": {
                        "$ref": "#/components/schemas/Author"
                    },
                    "entryBytes": {
                        "type": "string"
                    },
                    "entryHash": {
                        "$ref": "#/components/schemas/Author"
                    },
                    "logId": {
                        "type": "number"
                    },
                    "payloadBytes": {
                        "type": "string"
                    },
                    "payloadHash": {
                        "$ref": "#/components/schemas/Author"
                    },
                    "seqNum": {
                        "type": "number"
                    }
                }
            },
            "EntryEncoded": {
                "type": "string"
            },
            "MessageEncoded": {
                "type": "string"
            },
            "Entries": {
                "type": "array",
                "items": {
                    "$ref": "#/components/schemas/Entry"
                }
            },
            "QueryEntriesResponse": {
                "type": "object",
                "properties": {
                    "entries": {
                        "$ref": "#/components/schemas/Entries"
                    }
                }
            }
        },
        "examples": {
            "SecondEntryEncoded": {
                "name": "firstEntryEncoded",
                "summary": "Encoded bytes of first entry in a log",
                "value": {
                    "$ref": "./test/test-data.json#/secondEntry/encoded/entryBytes"
                }
            },
            "SecondEntryMessageEncdoded": {
                "name": "messageEncoded",
                "summary": "Encoded bytes of first entry payload",
                "value": {
                    "$ref": "./test/test-data.json#/secondEntry/encoded/payloadBytes"
                }
            },
            "ThirdEntryArgsResult": {
                "name": "testEntryArgumentsResult",
                "value": {
                    "entryHashSkiplink": {
                        "$ref": "./test/test-data.json#/thirdEntryArgs/entryHashSkiplink"
                    },
                    "entryHashBacklink": {
                        "$ref": "./test/test-data.json#/thirdEntryArgs/entryHashBacklink"
                    },
                    "seqNum": {
                        "$ref": "./test/test-data.json#/thirdEntryArgs/seqNum"
                    },
                    "logId": {
                        "$ref": "./test/test-data.json#/thirdEntryArgs/logId"
                    }
                }
            },
            "Author": {
                "name": "author",
                "value": {
                    "$ref": "./test/test-data.json#/firstEntry/encoded/author"
                }
            },
            "Schema": {
                "name": "schema",
                "value": {
                    "$ref": "./test/test-data.json#/firstEntry/message/schema"
                }
            },
            "Entries": {
                "name": "entries",
                "value": {
                    "entries": [
                        {
                            "author": {
                                "$ref": "./test/test-data.json#/firstEntry/encoded/author"
                            },
                            "entryBytes": {
                                "$ref": "./test/test-data.json#/firstEntry/encoded/entryBytes"
                            },
                            "entryHash": {
                                "$ref": "./test/test-data.json#/firstEntry/encoded/entryHash"
                            },
                            "logId": {
                                "$ref": "./test/test-data.json#/firstEntry/logId"
                            },
                            "payloadBytes": {
                                "$ref": "./test/test-data.json#/firstEntry/encoded/payloadBytes"
                            },
                            "payloadHash": {
                                "$ref": "./test/test-data.json#/firstEntry/encoded/payloadHash"
                            },
                            "seqNum": {
                                "$ref": "./test/test-data.json#/firstEntry/seqNum"
                            }
                        },
                        {
                            "author": {
                                "$ref": "./test/test-data.json#/secondEntry/encoded/author"
                            },
                            "entryBytes": {
                                "$ref": "./test/test-data.json#/secondEntry/encoded/entryBytes"
                            },
                            "entryHash": {
                                "$ref": "./test/test-data.json#/secondEntry/encoded/entryHash"
                            },
                            "logId": {
                                "$ref": "./test/test-data.json#/secondEntry/logId"
                            },
                            "payloadBytes": {
                                "$ref": "./test/test-data.json#/secondEntry/encoded/payloadBytes"
                            },
                            "payloadHash": {
                                "$ref": "./test/test-data.json#/secondEntry/encoded/payloadHash"
                            },
                            "seqNum": {
                                "$ref": "./test/test-data.json#/secondEntry/seqNum"
                            }
                        }
                    ]
                }
            }
        }
    },
    "methods": [
        {
            "name": "panda_getEntryArguments",
            "summary": "Get arguments for building next entry",
            "params": [
                {
                    "$ref": "#/components/contentDescriptors/Author"
                },
                {
                    "$ref": "#/components/contentDescriptors/Schema"
                }
            ],
            "result": {
                "$ref": "#/components/contentDescriptors/EntryArgs"
            },
            "examples": [
                {
                    "name": "testEntryArgumentsExample",
                    "params": [
                        {
                            "$ref": "#/components/examples/Author"
                        },
                        {
                            "$ref": "#/components/examples/Schema"
                        }
                    ],
                    "result": {
                        "$ref": "#/components/examples/ThirdEntryArgsResult"
                    }
                }
            ]
        },
        {
            "name": "panda_queryEntries",
            "params": [
                {
                    "$ref": "#/components/contentDescriptors/Schema"
                }
            ],
            "result": {
                "name": "query response",
                "schema": {
                    "$ref": "#/components/schemas/QueryEntriesResponse"
                }
            },
            "examples": [
                {
                    "name": "testQueryExample",
                    "params": [
                        {
                            "$ref": "#/components/examples/Schema"
                        }
                    ],
                    "result": {
                        "$ref": "#/components/examples/Entries"
                    }
                }
            ]
        },
        {
            "name": "panda_publishEntry",
            "params": [
                {
                    "name": "entryEncoded",
                    "schema": {
                        "$ref": "#/components/schemas/EntryEncoded"
                    }
                },
                {
                    "name": "messageEncoded",
                    "schema": {
                        "$ref": "#/components/schemas/MessageEncoded"
                    }
                }
            ],
            "result": {
                "$ref": "#/components/contentDescriptors/EntryArgs"
            },
            "examples": [
                {
                    "name": "publishEntryResultExample",
                    "params": [
                        {
                            "$ref": "#/components/examples/SecondEntryEncoded"
                        },
                        {
                            "$ref": "#/components/examples/SecondEntryMessageEncdoded"
                        }
                    ],
                    "result": {
                        "$ref": "#/components/examples/ThirdEntryArgsResult"
                    }
                }
            ]
        }
    ]
}